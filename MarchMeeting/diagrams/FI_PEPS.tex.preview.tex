%& C:\Users\Brayden\AppData\Roaming\TikzEdt\TikzEdt\023~1.0\TEMP_H~1
\begin{document}
\definecolor{airorange}{rgb}{.953 ,.502 ,.04}
\definecolor{airdarkblue}{HTML}{064F6F}
\definecolor{airlightblue}{HTML}{0099d5}
\tikzset{half/.style={circle=3pt,draw=black!100, semithick, fill=airorange!50, inner sep=1.3pt}}
\tikzset{empty/.style={circle=3pt,draw=black!100,fill=airorange!00,inner sep=1.4pt}}
\tikzset{filled/.style={circle=3pt,draw=black!100,fill=airorange!100,inner sep=1.4pt}}
\tikzset{eli/.style={ellipse, rotate=0, draw=black, fill=gray!20, ,inner sep=5pt}}

%http://tex.stackexchange.com/questions/6019/drawing-hexagons
\begin{tikzpicture}[x=11.25mm,y=6.5mm]
  
  \clip (0, -1.4) rectangle (4, 5);
  
  \tikzset{
    box/.style={
      regular polygon,
      regular polygon sides=6,
      minimum size=15mm,
      inner sep=0mm,
      outer sep=0mm,
      rotate=0,
     dotted,
     thin,
      black,
      draw
    }
  }

    \tikzset{
    wb/.style={
       regular polygon,
      regular polygon sides=6,
      minimum size=3mm,
      %fill,
      inner sep=0mm,
      outer sep=0mm,
      rotate=0,
     % dotted,
     very thick,
     airlightblue,
      draw
    }
  }
\foreach \i in {0,...,2} 
    \foreach \j in {-1,...,2} {
    \pgfmathtruncatemacro{\x}{2*\i}
    \pgfmathtruncatemacro{\y}{2*\j}
     \node[box] (H\x\y) at (\x,\y) {};
     \foreach \k in {1, ..., 6}{
     \node[eli] at (H\x\y.corner \k){};
     }
    }
    
    \foreach \i in {0,...,1} 
    \foreach \j in {-1,..., 2} {
   \pgfmathtruncatemacro{\x}{2*\i+1}
    \pgfmathtruncatemacro{\y}{2*\j+1}
    \node[box] (H\x\y) at (\x,\y) {};
    \foreach \k in {1, ..., 6}{
    \node[eli] at (H\x\y.corner \k){};
    }    
    }

\foreach \i in {0,...,2} 
    \foreach \j in {-1,...,2} {
    \pgfmathtruncatemacro{\x}{2*\i}
    \pgfmathtruncatemacro{\y}{2*\j}
           
            \node[wb] (W\x\y) at (\x,\y) {};
             % \node[green] at (\x, \y) {\tiny W};
             \foreach \k in {1, ..., 6}{
             \node[inv] (D\x\y\k) at (H\x\y.corner \k) {};
             \draw[very thick, airlightblue] (W\x\y) -- node [pos=0.98, half] {} (D\x\y\k);
             }
        }
\foreach \i in {0,...,1} 
    \foreach \j in {-1,..., 2} {
        \pgfmathtruncatemacro{\x}{2*\i+1}
    \pgfmathtruncatemacro{\y}{2*\j+1}
   	  
   	   \node[wb] (W\x\y) at (\x,\y) {};
   	   % \node[green] at (\x, \y) {\tiny W};
             \foreach \k in {1, ..., 6}{
             \node[inv] (D\x\y\k) at (H\x\y.corner \k) {};
             \draw[very thick, airlightblue] (W\x\y) -- node [pos=0.98, half] {} (D\x\y\k);
             }
        }
%\draw[black] (0, -1) rectangle (4, 5);

\usetikzlibrary{calc}
\pgftransformreset
\node[inner sep=0pt,outer sep=0pt,minimum size=0pt,line width=0pt,text width=0pt,text height=0pt] at (current bounding box) {};
%add border to avoid cropping by pdflibnet
\foreach \border in {0.1}
  \useasboundingbox (current bounding box.south west)+(-\border,-\border) rectangle (current bounding box.north east)+(\border,\border);
\newwrite\metadatafile
\immediate\openout\metadatafile=\jobname_BB.txt
\path
  let
    \p1=(current bounding box.south west),
    \p2=(current bounding box.north east)
  in
  node[inner sep=0pt,outer sep=0pt,minimum size=0pt,line width=0pt,text width=0pt,text height=0pt,draw=white] at (current bounding box) {
\immediate\write\metadatafile{\p1,\p2}
};
\immediate\closeout\metadatafile
\end{tikzpicture}

\end{document}

%!TEX root = ../thesis.tex

\begin{tikzpicture}[node distance=0.4cm]

\node[gamma] (G1) at (0,0) {};
\node[gamma] (G2) at (2,0) {};

\node[lambda] (l1) at (-1,0) {};
\node[lambda] (l2) at (1,0) {};
\node[lambda] (l3) at (3,0) {};

\draw[thick] ($ (l1) + (-0.5,0) $) -- (l1) -- (G1) -- (l2) -- (G2) -- (l3) -- ($ (l3) + (0.5,0) $);
%\draw[thick] (G1) -- ($ (G1) + (0,-0.5) $);
%\draw[thick] (G2) -- ($ (G2) + (0,-0.5) $);

\node[above of=G1] {$\Gamma^1$};
\node[above of=G2] {$\Gamma^2$};

\foreach \i in {1,2,3}
{
	\node[below of=l\i] {$\lambda^\i$};
}

\node[operator] (op) at (1,-1) {};
\node[below of=op,node distance=0.4cm] {$U$};

\draw[thick] (G1) to [bend right=20] (op);
\draw[thick] (G2) to [bend left=20] (op);

\draw[thick] (op) to [bend right=20] ($ (G1) + (0,-1.7) $);
\draw[thick] (op) to [bend left=20] ($ (G2) + (-0,-1.7) $);

% next panel

\node[circle=6pt,draw=black!100,fill=blue!50,inner sep=6pt] (Gp) at (7,-1.5) {};
\draw[thick] (Gp.south east) -- ($ (Gp.south east) + (0,-0.5) $);
\draw[thick] (Gp.south west) -- ($ (Gp.south west) + (0,-0.5) $);
\draw[thick] (Gp) -- ($ (Gp) + (-1,0) $);
\draw[thick] (Gp) -- ($ (Gp) + (1,0) $);
\node[above of=Gp,node distance=0.6cm] {$\theta = \tilde{\Gamma}^1 \tilde{\lambda}^2 \tilde{\Gamma}^2 $};

% next panel

\node[gamma] (G1) at (0,-3) {};
\node[gamma] (G2) at (2,-3) {};

\node[lambda] (l1) at (-1,-3) {};
\node[lambda] (l2) at (1,-3) {};
\node[lambda] (l3) at (3,-3) {};

\draw[thick] ($ (l1) + (-0.5,0) $) -- (l1) -- (G1) -- (l2) -- (G2) -- (l3) -- ($ (l3) + (0.5,0) $);
\draw[thick] (G1) -- ($ (G1) + (0,-0.5) $);
\draw[thick] (G2) -- ($ (G2) + (0,-0.5) $);

\node[above of=G1] {$(\lambda^1)^{-1} \tilde{\Gamma}^1$};
\node[above of=G2] {$\tilde{\Gamma}^2 (\lambda^3)^{-1}$};

\node[below of=l1] {$\lambda^1$};
\node[below of=l2] {$\tilde{\lambda}^2$};
\node[below of=l3] {$\lambda^3$};

% arrows

\draw[very thick,->,double] (4,0) -- node[above right] {Contraction} ($ (Gp.north west) + (-1,0.5) $);
\draw[very thick,->,double] ($ (Gp.south west) + (-1,-0.75) $) -- node[below right] {Singular value decomposition} (4,-3);

\end{tikzpicture}

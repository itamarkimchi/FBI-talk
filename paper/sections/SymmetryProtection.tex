%!TEX root = ../fbi.tex

\section{Symmetry protection}
\label{sec:symmetry}

\subsection{Overview}

While the gapless entanglement spectrum observed above is consistent with a symmetry-protected
topological phase, it does not by itself guarantee the presence of such a robust phase, and does not
allow us to interfere which symmetries are protecting the topological properties of the phase.
A key observation that allows us to make progress on these crucial questions is that many points
in the entanglement spectrum are degenerate. In particular, we find that for cylinders of odd circumference,
the entire spectrum is doubly degenerate.
In this section, we will discuss how
the corresponding degenerate Schmidt states are related through the action of a symmetry of the HFBI wavefunction. 
As discussed in Ref.~\onlinecite{pollmann2010} and reviewed in the Appendix~\ref{Appendix:MPS},
this symmetry action can be used to diagnose one-dimensional symmetry protected topological order,
for which the degeneracy throughout the entire entanglement spectrum is a robust feature.
We will demonstrate that the odd circumference cylinders, considered as quasi-one-dimensional states, 
are indeed SPTs protected by a combination of lattice inversion and charge parity symmetries.

While the Schmidt eigenstates are uniquely defined for non-degenerate eigenvalues of the reduced
density matrix, they are not unique when the spectrum is degenerate and any choice of orthonormal
states in the degenerate subspace represents a valid choice of Schmidt states. Applying
a unitary transformation $V^{ji}$, which respects $\sum_i V^{ji} (V^{ki})^* = \delta_{jk}$, on the
left Schmidt states must be accompanied by an appropriate transformation $(V^{ji})^*$ applied to
the right Schmidt states..

In particular, this allows the action of an on-site symmetry (or more generally, any symmetry which commutes
separately with the reduced density matrices for the left and right half) to mix Schmidt states corresponding
to degenerate eigenvalues. The action of a symmetry operator $U_g$ takes the form
\beq
\label{eq:symschmidt}
\begin{split}
U_g \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{L}} V_g^{ji} \\
U_g \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{R}} \left(V_g^{ki} \right)^*,
\end{split}
\eeq
where the $V_g^{ji}$ are unitary matrices that only act on degenerate blocks of Schmidt states.
Crucially, Ref.~\onlinecite{pollmann2010} describes a numerical procedure to calculate $V_g$ for
an on-site symmetry $g$ within the MPS formalism, which we review in Appendix~\ref{Appendix:MPS}.

We can also analyze the effects of symmetry that preserve the entanglement cut but swap
the left and right of the cylinders. In general, we will consider 
any symmetry $h$ that swaps the cylinder sides and squares to the identity, which we will call an 
inverting symmetry. These satisfy a modification of~\eqnref{eq:symschmidt}:
\beq
\label{eq:isymschmidt}
\begin{split}
U_{h} \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{R}} V_{h}^{ji} \\
U_{h} \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{L}} \left( V_{h}^{ki} \right)^*.
\end{split}
\eeq
Note here that the left and right Schmidt states are exchanged in the transformation. Together
with the requirement that the symmetry squares to the identity, this requires that
(where $\mathbf{K}$ represents complex conjugation in the canonical basis)
\begin{equation}
V_h V_h^* = (V_h \mathbf{K})^2 = e^{i \phi_h} I = \pm I,
\end{equation}
that is the inverting symmetry forms an anti-unitary projective representation of $\mathbb{Z}_2$.

As reviewed in Appendix~\ref{Appendix:MPS}, the collection of $V_g$ of on-site symmetries 
sometimes fail to satisfy the group multiplication laws, i.e. one may find $V_{g_1 g_2} \neq V_{g_1} V_{g_2}$.
Instead, they may form a projective representation, where group multiplication laws are obeyed up
to phases $\omega(g_1, g_2)$, i.e. $V_{g_1} V_{g_2} = \omega(g_1, g_2) V_{g_1 g_2}$.
The equivalence classes of $\omega(g_1, g_2)$ are classified by the elements of $H^2(G, U(1))$. 
If the element is non-trivial, i.e. there exist $g_1$, $g_2$ such that $\omega(g_1,g_2) \neq 1$,
the degeneracy in the entanglement spectrum on which $V_g$ acts cannot be removed
without breaking the symmetry, since the distinct classes of $H^2(G, U(1))$ cannot be
connected continuously. \bela{This is not obvious and needs a citation.}
Similarly, for the inverting (anti-unitary) symmetries $h$, the phase $\phi_h = -1$ signifies that 
the degeneracy cannot be removed without breaking the symmetry.

\subsection{Symmetry protection of the HFBI}

The on-site symmetries of the featureless boson insulator considered here
are the $U(1)$ charge symmetry and the 
anti-unitary symmetry $\tau$, which acts by complex conjugation in the boson number basis.
Despite being at half-filling, the hard-core boson variant of the state does not have a particle-hole
symmetry. Exploring the edge action of these symmetries numerically, we find that they are all
represented linearly and thusdo not protect the degeneracy of the entanglement spectrum
on cylinders of odd circumference.
In order to protect the degeneracy, we must therefore include lattice symmetries.

In the cylinder geometry chosen, the group of lattice symmetries consists of translations 
- generated by $T_x$ parallel and $T_y$ perpendicular to the cylinder axis-
as well as reflections $\I_x$ through a line parallel 
and $\I_y$ through a line perpendicular to the cylinder axis. 
We also consider lattice inversion $\I = \I_x \I_y$, equivalent to a $\pi$ 
rotation of the spatial plane about the center of a hexagonal plaquette.

We can immediately see from symmetry considerations that $V_{\I}$ will map each Schmidt 
state to a state with the same entanglement energy and momentum, but with opposite charge.
Thus $V_{\I}$ acts on the degenerate pairs of states $\ket{e, K}$ and $\ket{-e, K}$ which
appear in Figure~\ref{fig:ESL910}. 

Our numerical results show that 
$$
V_{\mathcal{I}} V_{\mathcal{I}}^* = I, 
$$
but
$$
V_{\varPi \mathcal{I}} V_{\varPi \mathcal{I}}^* = -I 
$$
where $\varPi = e^{i \pi \mathcal{Q}} \in U(1)$ is the charge parity symmetry.


%However, the entanglement spectrum of this one wavefunction is not enough to
%determine the SPT nature of the phase. First, it isn't clear what group or
%groups of symmetries can be used to protect the gapless edge. It could be that
%the entire symmetry group - $U(1)$ boson number conservation, \brayden{time
%reversal symmetry?}, as well as the entire rotational and translational group
%of the lattice - must be preserved to protect the edge. Or, as we will argue
%is the case, a much smaller subgroup could be used to protect the edge. This
%leads to a wider class of perturbations that leave the edge intact - and since
%we will argue that translation is not needed for protection, the gapless edge should additonally be robust to some types of weak disorder and can be seen in
%small systems with symmetry preserving boundary conditions. Second, the
%entanglement spectrum alone fails to distinguish between other SPT phases with
%the same protecting group - for that, we need a topological invariant. Third,
%we would like to confirm the SPT nature of the phase by perturbing a parent
%Hamiltonian with terms that break various combinations of symmetries and
%seeing if they destroy the gapless edge.

%To determine the protecting group, we can proceed in
%two ways: we could perturb a parent Hamiltonian with terms that break various
%combinations of symmetries and see which perturbations destroy the gapless
%edge, or we can look for a topological invariant by analyzing the action of
%the symmetry of the entanglement edge. We will take up the later question
%first, then return to the prospect of perturbing a parent Hamiltonian in
%Section \ref{sec:perturbations}.


%Given that only odd circumference cylinders are SPTs, one might wonder whether
%odd and even $L$ cylinders approach two differt phases in the thermodynamic
%limit. In Section~\ref{sec:CFT}, we will provide evidence against that
%possibility, by showing that in both cases, the low-energy, linear dispersing
%part of the entanglement spectra can be described by the same conformal field
%theory. Thus, in the thermodynamic limit, the two edge spectra approach the
%same set of points.



\brayden{1D SPT -> 2D SPT+translation:
The degenerate entanglement spectra on odd circumference cylinders should be a feature 
robust to small perturbations of any parent Hamiltonian for this state, as long as the 
perturbations respect the above symmetry, and as long as perturbations respect the translational
symmetry of the lattice - so that the notion of 'odd circumference cylinder' is well defined.
So the 1D SPT result can be extended to a 2D SPT result, as long as we include translational
symmetry in the protecting group. It may be that translational symmetry isn't actually necessary
to argue for this protection, but additional evidence is needed to argue for that. 
}
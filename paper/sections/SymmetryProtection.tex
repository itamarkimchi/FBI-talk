%!TEX root = ../fbi.tex

\section{Symmetry protection}
\label{sec:symmetry}

\subsection{Overview}

While the gapless entanglement spectrum observed above is consistent with a symmetry-protected
topological phase, it does not by itself guarantee the presence of such a robust phase, and does not
allow us to infer which symmetries are protecting the topological properties of the phase.
A key observation that allows us to make progress on these crucial questions is that many points
in the entanglement spectrum are degenerate. In particular, we find that for cylinders of odd circumference,
the entire spectrum is doubly degenerate.
In this section, we will discuss how
the corresponding degenerate Schmidt states are related through the action of a symmetry of the HFBI wavefunction. 
As discussed in Ref.~\onlinecite{pollmann2010} and reviewed in the Appendix~\ref{Appendix:MPS},
this symmetry action can be used to diagnose one-dimensional symmetry protected topological order,
for which the degeneracy throughout the entire entanglement spectrum is a robust feature.
We will demonstrate that the odd circumference cylinders, considered as quasi-one-dimensional states, 
are indeed SPTs protected by a combination of lattice inversion and charge parity symmetries.

While the Schmidt eigenstates are uniquely defined for non-degenerate eigenvalues of the reduced
density matrix, they are not unique when the spectrum is degenerate and any choice of orthonormal
states in the degenerate subspace represents a valid choice of Schmidt states. Applying
a unitary transformation $V^{ji}$, which respects $\sum_i V^{ji} (V^{ki})^* = \delta_{jk}$, on the
left Schmidt states must be accompanied by an appropriate transformation $(V^{ji})^*$ applied to
the right Schmidt states.

In particular, this allows the action of an on-site symmetry (or more generally, 
any symmetry which commutes separately with the reduced density matrices
for the left and right half) to mix Schmidt states corresponding to degenerate eigenvalues.
The action of such a symmetry operator $U_g$ takes the form
\beq
\label{eq:symschmidt}
\begin{split}
U_g \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{L}} V_g^{ji} \\
U_g \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{R}} \left(V_g^{ki} \right)^*,
\end{split}
\eeq
where the $V_g^{ji}$ are unitary matrices that only act on degenerate blocks of Schmidt states.
Crucially, Ref.~\onlinecite{pollmann2010} describes a numerical procedure to calculate $V_g$ for
an on-site symmetry $g$ within the MPS formalism, which we review in Appendix~\ref{Appendix:MPS}.

We can also analyze the effects of symmetries that preserve the entanglement cut but swap
the left and right halves of the cylinders. In general, we will consider 
any symmetry $h$ that swaps the cylinder sides and squares to the identity, which we will call an 
inverting symmetry. These satisfy a modification of~\eqnref{eq:symschmidt}:
\beq
\label{eq:isymschmidt}
\begin{split}
U_{h} \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{R}} V_{h}^{ji} \\
U_{h} \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{L}} \left( V_{h}^{ki} \right)^*.
\end{split}
\eeq
Note here that the left and right Schmidt states are exchanged in the transformation. We can
introduce a map $S$ that acts as
\beq
S \ket{\psi^{(i)}_{R}} = \ket{\psi^{(i)}_{L}}.
\eeq
Since a change in phase $\ket{\psi^{(i)}_{R}} \to e^{i \varphi} \ket{\psi^{(i)}_{R}}$ must be
accompanied by the complex conjugate $\ket{\psi^{(i)}_{L}} \to e^{-i \varphi} \ket{\psi^{(i)}_{L}}$
to preserve the Schmidt decomposition, $S$ is antiunitary.

Combining the above, we see that
\beq
\label{eq:isymschmidt2}
U_h S \ket{\psi^{(i)}_{R}} = \sum\limits_j \ket{\psi^{(j)}_{R}} V_{h}^{ji}
\eeq
defines the action of the operator $U_h S$ on the right Schmidt states (of course an equivalent
action can be defined on the left Schmidt states). Since $S$ is anti-unitary, the combined action
of $U_h S$ is also anti-unitary.
Together with the requirement that the symmetry squares to the identity, one finds that
(where $\mathbf{K}$ represents complex conjugation in the canonical basis)
\begin{equation}
\label{eq:antiunitarysym}
V_h V_h^* = (V_h \mathbf{K})^2 = e^{i \phi_h} I = \pm I,
\end{equation}
that is the inverting symmetry forms an anti-unitary projective representation of $\mathbb{Z}_2$.

As reviewed in Appendix~\ref{Appendix:MPS}, the collection of $V_g$ of on-site symmetries 
sometimes fail to satisfy the group multiplication laws, i.e. one may find $V_{g_1 g_2} \neq 
V_{g_1} V_{g_2}$.
Instead, they may form a projective representation, where group multiplication laws are obeyed up
to phases $\omega(g_1, g_2)$, i.e. $V_{g_1} V_{g_2} = \omega(g_1, g_2) V_{g_1 g_2}$.
Certain combinations of these phases - such as 
\beq
e^{i\phi_{g_1, g_2}} \equiv \frac{\omega(g_1, g_2)}{\omega(g_2, g_1)}
\eeq
whenever $[g_1, g_2] = 0$ - are \em symmetry protected topological invariants\em, which take 
discrete values and hence cannot be changed continuously.
$\phi_{g_1, g_2} \neq 0$ signifies that the entanglement degeneracy cannot be removed without 
breaking the symmetry or going through a phase transition.
Similarly, for the inverting (anti-unitary) symmetries $h$, the phase $\phi_h = \pi$ in 
Equation~\ref{eq:antiunitarysym} signifies that 
the degeneracy cannot be removed without breaking the symmetry.\cite{pollmann2010}

\subsection{Symmetry protection of the HFBI}

The on-site symmetries of the featureless boson insulator considered here
are the $U(1)$ charge symmetry and the 
anti-unitary symmetry $\tau$, which acts by complex conjugation in the boson number basis.
Despite being at half-filling, the hard-core boson variant of the state does not have a particle-hole
symmetry. Exploring the edge action of these symmetries numerically, we find that they are all
represented linearly and thus do not protect the degeneracy of the entanglement spectrum
on cylinders of odd circumference.
In order to protect the degeneracy, we must therefore include lattice symmetries.

By choosing a cylinder geometry, we explicitly break some of the lattice rotational
and reflection symmetries. The remaining symmetries are generated by
translations $T_x$ parallel and $T_y$ perpendicular to the cylinder axis
as well as reflections $\I_x$ through a line parallel and $\I_y$ through a line perpendicular to 
the cylinder axis. We also consider lattice inversion $\I = \I_x \I_y$, equivalent to a $\pi$ 
rotation of the spatial plane about the center of a hexagonal plaquette. We find that including
these symmetries allows us to define a number of SPT invariants which are non-trivial
for the HFBI and explain the doubly degenerate entanglement spectrum on odd circumference 
cylinders. The complete list of non-trivial invariants is summarized in Table~\ref{table:sym}. 

The crucial ingredient underlying these SPT invariants is a spatial symmetry $h$ that swaps the 
two sides of the entanglement cut. 
By a general symmetry analysis of Equation~\ref{eq:isymschmidt2}, $V_h$ must act as a 
particle-hole symmetry on the edge, since the Schmidt pairing $S$ pairs states with
opposite quantum numbers. In this case, the symmetry action $V_{\I_y}$ is precisely
a particle-hole symmetry in the local PEPS basis:
$$
V_{\I_y}\vket{\sigma_1, \ldots, \sigma_{W}} = \vket{1-\sigma_1, \ldots, 1-\sigma_{W}}, 
$$
since a state where the $i^{th}$ hexagon contributes $\sigma_i$ bosons on the right is paired with
a state where the $i^{th}$ hexagon contributes $1-\sigma_i$ on the left.
When $W$ is odd, these states have opposite charge parity, so charge parity fails to commute with
the action of the inverting symmetry.

Specifically, if $\varPi = e^{i \pi \mathcal{Q}} \in U(1)$ is the charge parity symmetry, we have
\begin{equation*}
\begin{split}
V_{\varPi} V_{\I_y}\vket{\sigma_1, \ldots, \sigma_{W}} &= (-1)^{W/2-\sum\sigma_i} \vket{1-\sigma_1, \ldots, 1-\sigma_{W}}, \\
V_{\I_y} V_{\varPi} \vket{\sigma_1, \ldots, \sigma_{W}} &= (-1)^{\sum\sigma_i-W/2} \vket{1-\sigma_1, \ldots, 1-\sigma_{W}}, \\
\end{split}
\end{equation*}
which implies that 
\begin{equation}
V_{\varPi} V_{\I_y} = - V_{\I_y} V_{\varPi}
\label{eq:hfbisym}
\end{equation}
for the HFBI state.
(The convention of subtracting the average charge $W/2$ does not effect the relative charge parity 
and hence does not change this result.)
Since $V_{\varPi}$ and $V_{\I_y}$ don't commute but act on blocks of degenerate Schmidt states,
we see that those blocks will contain pairs of degenerate Schmidt states of opposite charge.

By phrasing this result in terms of an MPS SPT invariant, we get a guarantee that the 
degenerate Schmidt states remain unsplit as long as enough symmetry is preserved and no phase 
transition has occurred. There are several appropriate invariants, the simplest being  
$$
V_{\varPi \I} V_{\varPi \I}^* = -I. 
$$
From this we see that the charge, translation, and inversion symmetry can all 
be broken without splitting the entanglement degeneracy - as long as the single combined symmetry
$\varPi \I $ is preserved. This could be achieved for example by adding a staggered field 
$$
H' = h \sum\limits_{i} (-1)^i \left(b_i + b_i^{\dagger}\right),
$$
where the coefficients $(-1)^i$ takes opposite values on the two sublattices, 
to a Hamiltonian for the state. More complicated staggering fields that break translational 
symmetry but change sign under inversion can be also be used - additionally, the symmetry $\I_y$ 
can be used in place of $\I$ which protects against different sets of patterns of staggering the 
field.

It is easy to produce a variant on the HFBI state - unitarily related to the original
state by an on-site unitary and thus with the same entanglement spectrum - where the role
of $\varPi \I$ is played by $\I$. The degeneracy in this state would be unsplit by a uniform
field instead of a staggered field, which may be physically more interesting. 
This is discussed further in Appendix~\ref{Appendix:Variants}.

%\brayden{What do you think of this discussion?
%In the next section, we will discuss the consequences of this 1D symmetry protection 
%for perturbations of a quasi-local parent Hamiltonian. Most importantly, it tells us
%that the edge physics is not finely tuned but survives perturbations that respect the
%protecting symmetry; specifically, perturbations of the Hamiltonian that 
%remain on the honeycomb lattice,
%are invariant under $\varPi \I$,
%and have unique ground states on odd $W$ cylinders
%will also show the degenerate entanglement spectrum in their ground states.
%These conditions are enough to show that the state is a 2D SPT - that is, 
%it cannot be adiabatically connected to a product state - when both $\varPi \I$ and
%the translationally symmetry group of the lattice are preserved. Not breaking the
%translational symmetry group is necessary for the argument to go through, since spontaneous
%translational symmetry breaking leads to states that do not have unique ground states
%on odd $W$ cylinders - and explicit breaking of translational symmetry, say by adding sites
%off the honeycomb lattice, can blur the distinction between odd and even $W$ cylinders.
%On the other hand, this symmetry protection does not allow us to guarantee the thermodynamic
%degeneracy of the entanglement spectrum - such as a gapless entanglement edge - for regions
%that don't wrap around the cylinder or on even cylinder sizes. If a gapped and 2D local 
%parent Hamiltonian can be found, it is likely that arbitrary shaped entanglement cuts
%must show entanglement features if enough symmetry is protected - but the topological invariant 
%given is not enough evidence for that, and it is not clear how much symmetry will be needed.
%}

%Using the techniques of MPS, we can find a quasi-local parent Hamiltonian for a given
%fixed cylinder width $W$ that acts on neighboring cylinder slices. By adding perturbations
%to this Hamiltonian on a cylinder with $W=3$, we can check that the degeneracy of the
%entanglement spectrum does not get split even when charge and translational
%symmetry are explicitly broken, as long as $\varPi \I$ is unbroken. In addition, this
%symmetry protection implies a non-local string order parameter that detects this phase.

We can also form other symmetry groups that can protect the entanglement degeneracy by using
time reversal. 
Since $V_{\tau}$ and $V_{\I}$ acts antiunitarily, $V_{\tau \I}$ acts
unitarily on the edge. The $\mathbb{Z}_2 \times \mathbb{Z}_2$ group generated by
$\tau \I$ and $\varPi$ has a projective representation characterized by the 
topological invariant
\beq
V_{\varPi} V_{\tau \I} V_{\varPi}^{-1} V_{\tau \I}^{-1}
 = - I.
\eeq
 symmetry protection gives a distinct class of perturbations that cannot
split the entanglement degeneracy. For the HFBI state itself, $V_{\tau}$ acts as the identity in 
the basis $\vket{\{\sigma_i\}}$, so these equations are trivially follow from Equation~\ref{eq:hfbisym}. 
The complete set of symmetry groups we find is summarized in Table~\ref{table:sym}.


\begin{table}
\begin{tabular*}{\columnwidth}{@{\extracolsep{\stretch{1}}}*{5}{r}@{}}
\toprule
Group & Generators & Invariant & $i$ &$e, k$ \\
\midrule
$\mathbb{Z}_2^P$ & $\{\varPi \I \}$ 
& $V_{\varPi \I} V_{\varPi \I}^* = -I$ &$-$ & $ -, +$  \\
$\mathbb{Z}_2^P$ & $\{\varPi \I_y \}$ 
&$V_{\varPi \I_y} V_{\varPi \I_y}^* = -I$ &$-$ & $ -, -$\\
$\mathbb{Z}_2 \times \mathbb{Z}_2^{PT}$& $\{\varPi, \tau \I\}$ 
&$V_{\varPi} V_{\tau \I} V_{\varPi}^{-1} V_{\tau \I}^{-1} = -I$ &$+$ & $ -, -$\\
$\mathbb{Z}_2 \times \mathbb{Z}_2^{PT}$& $\{\varPi, \tau \I_y\}$
&$V_{\varPi} V_{\tau \I_y} V_{\varPi}^{-1} V_{\tau \I_y}^{-1} = -I$ &$+$ & $ -, +$\\
$\mathbb{Z}_2 \times \mathbb{Z}_2^{PT}$& $\{\varPi \I_x, \tau \I\}$
&$V_{\varPi \I_x} V_{\tau \I} V_{\varPi \I_x}^{-1} V_{\tau \I}^{-1} = -I$ &$+$ & $ -, ?$\\
$\mathbb{Z}_2 \times \mathbb{Z}_2^{PT}$& $\{\varPi \I_x, \tau \I_y\}$
&$V_{\varPi \I_x} V_{\tau \I_y} V_{\varPi \I_x}^{-1} V_{\tau \I_y}^{-1} = -I$ &$+$ & $ -, ?$\\
\bottomrule
\end{tabular*}
\caption{Summary of symmetry protecting invariants found for the HFBI state. 
The degenerate entanglement spectrum cannot be split unless all 6 of the  minimal protecting symmetry groups are broken.}
\label{table:sym}
\end{table}
%\begin{tabular*}{\columnwidth}{@{\extracolsep{\stretch{1}}}*{6}{r}@{}}
%\toprule
%$\mathbf{G}$ & i & Q & K & $\mathbf{\theta_g}$ & $\mathbf{\phi_g}$ \\
%\midrule
% $Id            $ & + & + & + & + & + \\
% $\varPi        $ & + & + & + & - & + \\
% $\I            $ & - & - & + & + & + \\
% $\tau          $ & - & + & - & + & + \\
% $\varPi \I     $ & - & - & + & - & - \\
% $\varPi \tau   $ & - & + & - & - & + \\
% $\tau \I       $ & + & - & - & + & + \\
% $\varPi \tau \I$ & + & - & - & - & - \\
%\bottomrule
%\end{tabular*}



%However, the entanglement spectrum of this one wavefunction is not enough to
%determine the SPT nature of the phase. First, it isn't clear what group or
%groups of symmetries can be used to protect the gapless edge. It could be that
%the entire symmetry group - $U(1)$ boson number conservation, \brayden{time
%reversal symmetry?}, as well as the entire rotational and translational group
%of the lattice - must be preserved to protect the edge. Or, as we will argue
%is the case, a much smaller subgroup could be used to protect the edge. This
%leads to a wider class of perturbations that leave the edge intact - and since
%we will argue that translation is not needed for protection, the gapless edge should additonally be robust to some types of weak disorder and can be seen in
%small systems with symmetry preserving boundary conditions. Second, the
%entanglement spectrum alone fails to distinguish between other SPT phases with
%the same protecting group - for that, we need a topological invariant. Third,
%we would like to confirm the SPT nature of the phase by perturbing a parent
%Hamiltonian with terms that break various combinations of symmetries and
%seeing if they destroy the gapless edge.

%To determine the protecting group, we can proceed in
%two ways: we could perturb a parent Hamiltonian with terms that break various
%combinations of symmetries and see which perturbations destroy the gapless
%edge, or we can look for a topological invariant by analyzing the action of
%the symmetry of the entanglement edge. We will take up the later question
%first, then return to the prospect of perturbing a parent Hamiltonian in
%Section \ref{sec:perturbations}.


%Given that only odd circumference cylinders are SPTs, one might wonder whether
%odd and even $L$ cylinders approach two differt phases in the thermodynamic
%limit. In Section~\ref{sec:CFT}, we will provide evidence against that
%possibility, by showing that in both cases, the low-energy, linear dispersing
%part of the entanglement spectra can be described by the same conformal field
%theory. Thus, in the thermodynamic limit, the two edge spectra approach the
%same set of points.
%!TEX root = ../fbi.tex

\section{Symmetry protection}
\label{sec:symmetry}

\subsection{Overview}

While the gapless entanglement spectrum observed above is consistent with a symmetry-protected
topological phase, it does not by itself guarantee the presence of such a robust phase, and does not
allow us to interfere which symmetries are protecting the topological properties of the phase.
A key observation that allows us to make progress on these crucial questions is that many points
in the entanglement spectrum are degenerate. In particular, we find that for cylinders of odd circumference,
the entire spectrum is doubly degenerate.
In this section, we will discuss how
the corresponding degenerate Schmidt states are related through the action of a symmetry of the HFBI wavefunction. 
As discussed in Ref.~\onlinecite{pollmann2010} and reviewed in the Appendix~\ref{Appendix:MPS},
this symmetry action can be used to diagnose one-dimensional symmetry protected topological order,
for which the degeneracy throughout the entire entanglement spectrum is a robust feature.
We will demonstrate that the odd circumference cylinders, considered as quasi-one-dimensional states, 
are indeed SPTs protected by a combination of lattice inversion and charge parity symmetries.

While the Schmidt eigenstates are uniquely defined for non-degenerate eigenvalues of the reduced
density matrix, they are not unique when the spectrum is degenerate and any choice of orthonormal
states in the degenerate subspace represents a valid choice of Schmidt states. Applying
a unitary transformation $V^{ji}$, which respects $\sum_i V^{ji} (V^{ki})^* = \delta_{jk}$, on the
left Schmidt states must be accompanied by an appropriate transformation $(V^{ji})^*$ applied to
the right Schmidt states.

In particular, this allows the action of an on-site symmetry (or more generally, 
any symmetry which commutes separately with the reduced density matrices
for the left and right half) to mix Schmidt states corresponding to degenerate eigenvalues.
The action of such a symmetry operator $U_g$ takes the form
\beq
\label{eq:symschmidt}
\begin{split}
U_g \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{L}} V_g^{ji} \\
U_g \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{R}} \left(V_g^{ki} \right)^*,
\end{split}
\eeq
where the $V_g^{ji}$ are unitary matrices that only act on degenerate blocks of Schmidt states.
Crucially, Ref.~\onlinecite{pollmann2010} describes a numerical procedure to calculate $V_g$ for
an on-site symmetry $g$ within the MPS formalism, which we review in Appendix~\ref{Appendix:MPS}.

We can also analyze the effects of symmetry that preserve the entanglement cut but swap
the left and right of the cylinders. In general, we will consider 
any symmetry $h$ that swaps the cylinder sides and squares to the identity, which we will call an 
inverting symmetry. These satisfy a modification of~\eqnref{eq:symschmidt}:
\beq
\label{eq:isymschmidt}
\begin{split}
U_{h} \ket{\psi^{(i)}_{L}} &= \sum\limits_j \ket{\psi^{(j)}_{R}} V_{h}^{ji} \\
U_{h} \ket{\psi^{(i)}_{R}} &= \sum\limits_k \ket{\psi^{(k)}_{L}} \left( V_{h}^{ki} \right)^*.
\end{split}
\eeq
Note here that the left and right Schmidt states are exchanged in the transformation.
The coefficients $V_h$ can be used to define a symmetry action on the right Schmidt states
\beq
\label{eq:isymschmidt2}
V_{h} \ket{\psi^{(i)}_{R}} = \sum\limits_j \ket{\psi^{(j)}_{R}} V_{h}^{ji}
\eeq
where $V_{h} = U_{h} S$ and 
\beq
S \ket{\psi^{(i)}_{R}} = \ket{\psi^{(i)}_{L}}.
\eeq
Crucially, the map $S$ that comes from the Schmidt pairing is antiunitary, since
a change in phase $\ket{\psi^{(i)}_{R}} \to e^{i \varphi} \ket{\psi^{(i)}_{R}}$ must be
accompanied by the complex conjugate $\ket{\psi^{(i)}_{L}} \to e^{-i \varphi} \ket{\psi^{(i)}_{L}}$
to preserve the Schmidt decomposition. Therefore $V_h$ is antiunitary.
Together with the requirement that the symmetry squares to the identity, one finds that
(where $\mathbf{K}$ represents complex conjugation in the canonical basis)
\begin{equation}
V_h V_h^* = (V_h \mathbf{K})^2 = e^{i \phi_h} I = \pm I,
\end{equation}
that is the inverting symmetry forms an anti-unitary projective representation of $\mathbb{Z}_2$.

As reviewed in Appendix~\ref{Appendix:MPS}, the collection of $V_g$ of on-site symmetries 
sometimes fail to satisfy the group multiplication laws, i.e. one may find $V_{g_1 g_2} \neq V_{g_1} V_{g_2}$.
Instead, they may form a projective representation, where group multiplication laws are obeyed up
to phases $\omega(g_1, g_2)$, i.e. $V_{g_1} V_{g_2} = \omega(g_1, g_2) V_{g_1 g_2}$.
The equivalence classes of $\omega(g_1, g_2)$ are classified by the elements of $H^2(G, U(1))$. 
If the element is non-trivial, i.e. there exist $g_1$, $g_2$ such that $\omega(g_1,g_2) \neq 1$,
the degeneracy in the entanglement spectrum on which $V_g$ acts cannot be removed
without breaking the symmetry, since the distinct classes of $H^2(G, U(1))$ cannot be
connected continuously. \bela{This is not obvious and needs a citation.}
Similarly, for the inverting (anti-unitary) symmetries $h$, the phase $\phi_h = -1$ signifies that 
the degeneracy cannot be removed without breaking the symmetry.\cite{pollmann2010}.

\subsection{Symmetry protection of the HFBI}

The on-site symmetries of the featureless boson insulator considered here
are the $U(1)$ charge symmetry and the 
anti-unitary symmetry $\tau$, which acts by complex conjugation in the boson number basis.
Despite being at half-filling, the hard-core boson variant of the state does not have a particle-hole
symmetry. Exploring the edge action of these symmetries numerically, we find that they are all
represented linearly and thus do not protect the degeneracy of the entanglement spectrum
on cylinders of odd circumference.
In order to protect the degeneracy, we must therefore include lattice symmetries.

%In the cylinder geometry chosen, the group of lattice symmetries consists of translations 
%- generated by $T_x$ parallel and $T_y$ perpendicular to the cylinder axis-
%as well as reflections $\I_x$ through a line parallel 
%and $\I_y$ through a line perpendicular to the cylinder axis. 
%We also consider lattice inversion $\I = \I_x \I_y$, equivalent to a $\pi$ 
%rotation of the spatial plane about the center of a hexagonal plaquette.
By choosing a cylinder geometry, we explicitly break some of the lattice rotational
and reflection symmetries. In this case, we will only need the lattice inversion $\I$,
a $\pi$ rotation of the spatial plane about the center of a hexagonal plaquette. 
By analysing Equation~\ref{eq:isymschmidt2}, one sees that $V_{\I}$ will map each Schmidt 
state to a state with the same entanglement energy and momentum, but with opposite charge -
since $U_{\I}$ flips momentum, but the Schmidt pairing $S$ pairs each state with a state of
opposite charge and momentum. 
Thus $V_{\I}$ swaps the degenerate pairs of states $\ket{e, m; n, \bar{n}}$ and
$\ket{-e, -m; \bar{n}, n}$ which appear in Figure~\ref{fig:ESL910}. 

Our numerical results show that 
$$
V_{\I} V_{\I}^* = I, 
$$
so inversion alone does not protect the degeneracy. Instead, we find that the
combined symmetry $\varPi \mathcal{I}$ protects the degeneracy:
$$
V_{\varPi \I} V_{\varPi \I}^* = -I 
$$
where $\varPi = e^{i \pi \mathcal{Q}} \in U(1)$ is the charge parity symmetry.
This can be understood simply. For odd $W$, where the charges $e$ are half-integer,
states with opposite charge $e$ and $-e$ also differ in charge parity. $V_{\varPi}$
acts with a relative phase between these states. Thus, if $V_{\I}$ squares
to $I$, $V_{\varPi \I}$ squares to $-I$, and vice versa.  
It is easy to produce a variant on the HFBI state with the opposite situation where
the roles of $\I$ and $\varPi \I$ are switched - this is discussed further in 
Appendix~\ref{Appendix:Variants}.

\brayden{What do you think of this discussion?}
In the next section, we will discuss the consequences of this 1D symmetry protection 
for perturbations of a quasi-local parent Hamiltonian. Most importantly, it tells us
that the edge physics is not finely tuned but survives perturbations that respect the
protecting symmetry; specifically, perturbations of the Hamiltonian that 
remain on the honeycomb lattice,
are invariant under $\varPi \I$,
and have unique ground states on odd $W$ cylinders
will also show the degenerate entanglement spectrum in their ground states.
These conditions are enough to show that the state is a 2D SPT - that is, 
it cannot be adiabatically connected to a product state - when both $\varPi \I$ and
the translationally symmetry group of the lattice are preserved. Not breaking the
translational symmetry group is necessary for the argument to go through, since spontaneous
translational symmetry breaking leads to states that do not have unique ground states
on odd $W$ cylinders - and explicit breaking of translational symmetry, say by adding sites
off the honeycomb lattice, can blur the distinction between odd and even $W$ cylinders.
On the other hand, this symmetry protection does not allow us to guarantee the thermodynamic
degeneracy of the entanglement spectrum - such as a gapless entanglement edge - for regions
that don't wrap around the cylinder or on even cylinder sizes. If a gapped and 2D local 
parent Hamiltonian can be found, it is likely that arbitrary shaped entanglement cuts
must show entanglement features if enough symmetry is protected - but the topological invariant 
given is not enough evidence for that, and it is not clear how much symmetry will be needed.

%Using the techniques of MPS, we can find a quasi-local parent Hamiltonian for a given
%fixed cylinder width $W$ that acts on neighboring cylinder slices. By adding perturbations
%to this Hamiltonian on a cylinder with $W=3$, we can check that the degeneracy of the
%entanglement spectrum does not get split even when charge and translational
%symmetry are explicitly broken, as long as $\varPi \I$ is unbroken. In addition, this
%symmetry protection implies a non-local string order parameter that detects this phase.

There is also a second symmetry group that can protect the entanglement degeneracy.
Since $V_{\tau}$ and $V_{\I}$ acts antiunitarily, one can show that $V_{\tau \I}$ acts
unitarily on the edge. The $\mathbb{Z}_2 \times \mathbb{Z}_2$ group generated by 
$\Pi$ and $\tau \I$ to act projectively on the edge. The relavant topological invariant
is given by 

\beq
V_{\varPi} V_{\tau \I} V_{\varPi}^{-1} V_{\tau \I}^{-1}
 = - I.
\eeq


\begin{tabular*}{\columnwidth}{@{\extracolsep{\stretch{1}}}*{6}{r}@{}}
\toprule
$\mathbf{G}$ & i & Q & K & $\mathbf{\theta_g}$ & $\mathbf{\phi_g}$ \\
\midrule
 $Id            $ & + & + & + & + & + \\
 $\varPi        $ & + & + & + & - & + \\
 $\I            $ & - & - & + & + & + \\
 $\tau          $ & - & + & - & + & + \\
 $\varPi \I     $ & - & - & + & - & - \\
 $\varPi \tau   $ & - & + & - & - & + \\
 $\tau \I       $ & + & - & - & + & + \\
 $\varPi \tau \I$ & + & - & - & - & - \\
\bottomrule
\end{tabular*}



%However, the entanglement spectrum of this one wavefunction is not enough to
%determine the SPT nature of the phase. First, it isn't clear what group or
%groups of symmetries can be used to protect the gapless edge. It could be that
%the entire symmetry group - $U(1)$ boson number conservation, \brayden{time
%reversal symmetry?}, as well as the entire rotational and translational group
%of the lattice - must be preserved to protect the edge. Or, as we will argue
%is the case, a much smaller subgroup could be used to protect the edge. This
%leads to a wider class of perturbations that leave the edge intact - and since
%we will argue that translation is not needed for protection, the gapless edge should additonally be robust to some types of weak disorder and can be seen in
%small systems with symmetry preserving boundary conditions. Second, the
%entanglement spectrum alone fails to distinguish between other SPT phases with
%the same protecting group - for that, we need a topological invariant. Third,
%we would like to confirm the SPT nature of the phase by perturbing a parent
%Hamiltonian with terms that break various combinations of symmetries and
%seeing if they destroy the gapless edge.

%To determine the protecting group, we can proceed in
%two ways: we could perturb a parent Hamiltonian with terms that break various
%combinations of symmetries and see which perturbations destroy the gapless
%edge, or we can look for a topological invariant by analyzing the action of
%the symmetry of the entanglement edge. We will take up the later question
%first, then return to the prospect of perturbing a parent Hamiltonian in
%Section \ref{sec:perturbations}.


%Given that only odd circumference cylinders are SPTs, one might wonder whether
%odd and even $L$ cylinders approach two differt phases in the thermodynamic
%limit. In Section~\ref{sec:CFT}, we will provide evidence against that
%possibility, by showing that in both cases, the low-energy, linear dispersing
%part of the entanglement spectra can be described by the same conformal field
%theory. Thus, in the thermodynamic limit, the two edge spectra approach the
%same set of points.